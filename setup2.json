{
  "hosts": [ "localhost" ],
  "user": "portal",
  "vhost": "poc",
  "password": "p0rtal",
  "exchanges": [
    {
      "exchangeName": "Emitter",
      "exchangeType": "Topic",
      "direction": "out",
      "durable": true,
      "autoDelete": false,
      "binding": {
        "exchanges": [
          {
            "exchangeName": "Translator",
            "routingKey":  "raw.#" 
          }
        ]
      }

    },
    {
      "exchangeName": "Translator",
      "exchangeType": "Topic",
      "direction": "in",
      "durable": true,
      "autoDelete": false,
      "binding": {
        "queues": [
          {
            "queueName": "Translator-{contentType}-{origin}",
            "routingKey":  "raw.{contentType}.{origin}.create" ,
            "durable": true,
            "arguments": {
              "x-max-priority": 10
            }
          }
        ]
      }

    },
    {
      "exchangeName": "Storage",
      "exchangeType": "Headers",
      "direction": "in",
      "durable": true,
      "binding": {
        "queues": [
          {
            "queueName": "Storage-Agency",
            "routingKey":  "#" ,
            "durable": true,
            "arguments": {}
          }
        ]
      }
    },
    {
      "exchangeName": "Document",
      "exchangeType": "Topic",
      "direction": "out",
      "durable": true,
      "binding": {
        "exchanges": [
          {
            "exchangeName": "EnricherCache",
            "routingKey":  "doc.*.*.create" 
          },
          {
            "exchangeName": "Indexer",
            "routingKey":  "doc.*.*.refresh" 
          },
          {
            "exchangeName": "Enricher",
            "routingKey": "doc.*.*.indexed"
          },
          {
            "exchangeName": "Storage",
            "arguments": {
              "serial": true
            }
          }
        ]
      }
    },
    {
      "exchangeName": "Enricher",
      "exchangeType": "Topic",
      "direction": "in",
      "durable": true,
      "binding": {
        "queues": [
          {
            "queueName": "Enricher-{contentType}-{origin}",
            "routingKey":  "doc.*.*.indexed" ,
            "durable": true,
            "arguments": {
              "x-max-priority": 10
            }
          }
        ]
      }
    },
    {
      "exchangeName": "Indexer",
      "exchangeType": "Topic",
      "direction": "in",
      "durable": true,
      "autoDelete": false,
      "binding": {
        "queues": [
          {
            "queueName": "Index-Create",
            "routingKey":  "doc.*.*.refresh" ,
            "durable": true,
            "arguments": {
              "x-max-priority": 10
            }
          },
          {
            "queueName": "Index-Update",
            "routingKey":  "partial.#" ,
            "durable": true,
            "arguments": {
              "x-max-priority": 10
            }
          }
        ]
      }
    },
    {
      "exchangeName": "PartialDocument",
      "exchangeType": "Topic",
      "direction": "out",
      "durable": true,
      "autoDelete": false,
      "binding": {
        "exchanges": [
          {
            "exchangeName": "EnricherCache",
            "routingKey":  "partial.#" 
          },
          {
            "exchangeName": "Indexer",
            "routingKey":  "partial.#" 
          }
        ]
      }
    },
    {
      "exchangeName": "EnricherCache",
      "exchangeType": "Topic",
      "direction": "in",
      "durable": true,
      "autoDelete": false,
      "binding": {
        "queues": [
          {
            "queueName": "EnricherCache-Write",
            "routingKey":  "partial.#" ,
            "durable": false,
            "arguments": {
              "x-max-priority": 10
            }
          },
          {
            "queueName": "EnricherCache-Delete",
            "routingKey":  "doc.*.*.delete" ,
            "durable": false,
            "arguments": {}
          },
          {
            "queueName": "EnricherCache-Refresh",
            "routingKey":  "doc.*.*.create" ,
            "durable": true,
            "arguments": {
              "x-max-priority": 10
            }
          }
        ]
      }
    }
  ]
}



